{"version":3,"sources":["../../app-es6/controllers/NegotiationController.js"],"names":["NegotiationController","$","document","querySelector","bind","_inputDate","_inputQuantity","_inputValue","_negotiationList","Bind","NegotiationList","NegotiationsView","_message","Message","MessageView","_currentOrder","_service","NegotiationService","_init","listNegotiations","then","negotiations","forEach","add","negotiation","catch","text","error","setInterval","importNegotiations","event","preventDefault","_createNegotiation","addNegotiation","message","_cleanForm","column","invertOrder","order","a","b","import","delete","emptyList","Negotiation","DateHelper","textToDate","value","parseInt","parseFloat","focus"],"mappings":"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","file":"NegotiationController.js","sourcesContent":["class NegotiationController {\n  constructor() {\n\n    let $ = document.querySelector.bind(document);\n\n    this._inputDate = $(\"#date\");\n    this._inputQuantity = $(\"#quantity\");\n    this._inputValue = $(\"#value\");\n\n\n    this._negotiationList = new Bind(\n      new NegotiationList(),\n      new NegotiationsView($(\"#negotiationsView\")),\n      'add', 'emptyList', 'order', 'invertOrder');\n\n    this._message = new Bind(\n      new Message(),\n      new MessageView($(\"#messageView\")),\n      'text');\n\n    this._currentOrder = '';\n\n    this._service = new NegotiationService();\n\n    this._init();\n\n\n  }\n\n  _init() {\n\n    this._service\n      .listNegotiations()\n      .then(negotiation => {\n        negotiations.forEach(negotiation =>\n          this._negotiationList.add(negotiation))\n      })\n      .catch(error => this._message.text = error);\n\n    setInterval(() => {\n      this.importNegotiations();\n    }, 2000);\n  }\n\n  add(event) {\n\n    event.preventDefault();\n\n    let negotiation = this._createNegotiation();\n\n    this._service\n      .addNegotiation(negotiation)\n      .then(message => {\n        this._negotiationList.add(negotiation);\n        this._message.text = message;\n        this._cleanForm();\n      })\n      .catch(error => this._message.text = error);\n  }\n\n  order(column) {\n    if (this._currentOrder == column) {\n      this._negotiationList.invertOrder();\n    } else {\n      this._negotiationList.order((a, b) => a[column] - b[column]);\n    }\n    this._currentOrder = column;\n  }\n\n  importNegotiations() {\n\n    this._service\n      .import(this._negotiationList.negotiations)\n      .then(negotiations => negotiations.forEach(negotiation => {\n        this._negotiationList.add(negotiation);\n        this._message.text = 'Negotiations were imported.';\n      }))\n      .catch(error => this._message.text = error);\n\n  }\n\n  delete() {\n\n    this._service\n      .delete()\n      .then(message => {\n        this._message.text = message;\n        this._negotiationList.emptyList();\n      })\n      .catch(error => this._message.text = error);\n\n  }\n\n  _createNegotiation() {\n    return new Negotiation(\n      DateHelper.textToDate(this._inputDate.value),\n      parseInt(this._inputQuantity.value),\n      parseFloat(this._inputValue.value)\n    );\n  }\n\n  _cleanForm() {\n    this._inputDate.value = \"\";\n    this._inputQuantity.value = 1;\n    this._inputValue.value = 0.0;\n    this._inputDate.focus();\n  }\n}\n"]}